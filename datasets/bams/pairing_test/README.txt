The pair_test.bam in this directory is a simulated e.coli dataset generated by
art illumina in September 2015.  The variant consists of 1020 bases from
e.coli chromosome F that were duplicated with a single changed base.

The SNP can be found if read pairing is working, otherwise it is not found.

Here is the methodology for how the dataset was produced:

* Extract chromosome F from e.coli

* Duplicate ~1000 bases from the middle to a position at least 2000bp away
  (1020 bases, lines 800-817 duplicated to line 1578, pos 94861)

* Import duplicated fasta as reference

  $ spiral import_reference chrF.nosnp.fasta e_coli_pairing_test

* Create a new fasta (chrF.snp.fasta) with the base at pos 94861 changed:

	TTTTTATAGTTTTTAGATCTTCTTTTTTAGAGCGCCTTGTAGGCCTTTATCCATGCTGGT
	ATTTTATAGTTTTTAGATCTTCTTTTTTAGAGCGCCTTGTAGGCCTTTATCCATGCTGGT

* Run art illumina to generate paired reads

  art_illumina \
	-1 /opt/art/Linux64/Illumina_profiles/EmpMiSeq250R1.txt \
	-2 /opt/art/Linux64/Illumina_profiles/EmpMiSeq250R2.txt \
	-o pair_test \
	-i chrF.snp.fasta \
	-l 100 -f 50 -m 500 -s 50 -qs 0 -qs2 0 -p -na

* Generate an aligned bam from the *.fq generated by art:

  bwa index chrF.nosnp.fasta
  bwa aln -t 24 chrF.nosnp.fasta pair_test1.fq > r1.sai
  bwa aln -t 24 chrF.nosnp.fasta pair_test2.fq > r2.sai
  bwa sampe chrF.nosnp.fasta r1.sai r2.sai pair_test1.fq pair_test2.fq >
  pair_test_aligned.sam
  samtools view -b -S pair_test_aligned.sam -o pair_test.bam

* Verify that anchored returns different results for paired vs. unpaired at that 
  location, run against the chrF.nosnp.fasta reference.

  $ diff unpaired_variants.vcf paired_variants.vcf
  37a38
  > F	94861	.	T	A	100	PASS
  > NS=1;DP=63;AID=0;FW=0.39;BQ=69	GT:DP:AD:OV	0/1:63:25,38:87

* Make a sequence set and readmap with biograph, using read correction:

  biograph create --correct-reads --in pair_test1.fq --pair pair_test2.fq --seqset pair_test.seqset --readmap --pair_test.readmap --ref /reference/e_coli_pairing_test/


This directory contains all of the intermediary files used to generate the dataset:

chrF.nosnp.fasta: 	e.coli chrF with the duplicated region
chrF.nosnp.fasta.*: 	bwa indices
chrF.snp.fasta:		e.coli chrF with the duplicated region and one SNP
*.fq:			paired reads generated by art illumina
*.sai:			generated during bwa alignment
*.aln:			alignment files generated by art illumina
pair_test_aligned.sam:	sam file aligned by bwa
pair_test.bam:		bam version of pair_test_aligned.sam
paired_variants.vcf: 	the detected SNP (when pairing is working)
unpaired_variants.vcf:	no SNP (pairing does not work)
pair_test.seqset:	seqset made with biograph create
pair_test.readmap:	readmap made with biograph create
